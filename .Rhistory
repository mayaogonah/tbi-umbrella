shapes = c(15, 17, 18)
shapes <- shapes[as.numeric(data$Group)]
if (!require("pacman")) install.packages("pacman")
library(pacman)
pacman::p_load(
meta,
extrafont,
effectsize,
metafor,
DescTools,
openxlsx,
tidyverse,
metafor,
cowplot
)
data <- read.xlsx("forest_plot.xlsx")
extrafont::font_import(prompt=FALSE)
loadfonts(device = "pdf")
par("family")
par(family = "Arial")
par("font")
shapes = c(15, 17, 18)
shapes <- shapes[as.numeric(data$Group)]
forest(x = data$Summary.Statistic, ci.lb = data$Lower.CI, ci.ub = data$Upper.CI,
slab = data$Health.Outcome,
psize = rep(1, length(data$Summary.Statistic)),
xlab = "Risk Ratio (RR)", refline = 1.0,
ylim = c(-0.5, 31), xlim = c(-6, 10),
ilab = c(data$Sample.size), ilab.xpos = -1,
at = c(0.5, 1.0, 2, 4, 8),
rows = c(1:2, 5, 8, 11:16, 19:27),
cex = 1.0, pch = shapes, header = "Health Outcome")
par(op)
op <- par(cex=1.0, font=2)
text(-6, c(3, 6, 9, 17, 28), pos = 4,
c("Severe TBI", "Moderate to Severe TBI", "Moderate TBI", "Mild TBI", "TBI of any severity"))
op <- par(cex=1.0, font=2)
text(7.9, 30.1, "RR")
shapes = c(15, 17, 18)
shapes <- shapes[as.numeric(data$Group)]
forest(x = data$Summary.Statistic, ci.lb = data$Lower.CI, ci.ub = data$Upper.CI,
slab = data$Health.Outcome,
psize = rep(1, length(data$Summary.Statistic)),
xlab = "Risk Ratio (RR)", refline = 1.0,
ylim = c(-0.5, 31), xlim = c(-6, 10),
ilab = c(data$Sample.size), ilab.xpos = -1,
at = c(0.5, 1.0, 2, 4, 8),
rows = c(1:2, 5, 8, 11:16, 19:27),
cex = 1.0, pch = shapes, header = "Health Outcome")
par(op)
op <- par(cex=1.0, font=2)
text(-6, c(3, 6, 9, 17, 28), pos = 4,
c("Severe TBI", "Moderate to Severe TBI", "Moderate TBI", "Mild TBI", "TBI of any severity"))
op <- par(cex=1.0, font=2)
text(7.9, 30.1, "RR")
op <- par(cex=1.0, font=2)
text(-1, 30.1, "Sample Size")
op <- par(cex=0.9, font=3)
text(-5.5, -0.3, "Key")
legend(x = -5.7,
y = -0.3,
legend = c("Hazard Ratio", "Risk Ratio", "Converted to Risk Ratio"),
pch = c(15, 17, 18),
bty = "n",
cex = 0.8,
text.font = 1)
if (!require("pacman")) install.packages("pacman")
library(pacman)
pacman::p_load(
meta,
extrafont,
effectsize,
metafor,
DescTools,
openxlsx,
tidyverse,
metafor,
cowplot,
robvis,
ggplot2
)
data <- read.xlsx("forest_plot.xlsx")
data_rob1 <- read.xlsx("amstar2_rob.xlsx")
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
warning = FALSE,
fig.width = 8,
fig.height = 2.41)
set.seed(42)
rob_tools()
rob_summary(data, tool = "Generic")
rob_summary(data, tool = "Generic")
shapes = c(15, 17, 18)
shapes <- shapes[as.numeric(data$Group)]
forest(x = data$Summary.Statistic, ci.lb = data$Lower.CI, ci.ub = data$Upper.CI,
slab = data$Health.Outcome,
psize = rep(1, length(data$Summary.Statistic)),
xlab = "Risk Ratio (RR)", refline = 1.0,
ylim = c(-0.5, 31), xlim = c(-6, 10),
ilab = c(data$Sample.size), ilab.xpos = -1,
at = c(0.5, 1.0, 2, 4, 8),
rows = c(1:2, 5, 8, 11:16, 19:27),
cex = 1.0, pch = shapes, header = "Health Outcome")
par(op)
op <- par(cex=1.0, font=2)
text(-6, c(3, 6, 9, 17, 28), pos = 4,
c("Severe TBI", "Moderate to Severe TBI", "Moderate TBI", "Mild TBI", "TBI of any severity"))
op <- par(cex=1.0, font=2)
text(7.9, 30.1, "RR")
op <- par(cex=1.0, font=2)
text(-1, 30.1, "Sample Size")
op <- par(cex=0.9, font=3)
text(-5.5, -0.3, "Key")
legend(x = -5.7,
y = -0.3,
legend = c("Hazard Ratio", "Risk Ratio", "Converted to Risk Ratio"),
pch = c(15, 17, 18),
bty = "n",
cex = 0.8,
text.font = 1)
shapes = c(15, 17, 18)
shapes <- shapes[as.numeric(data$Group)]
forest(x = data$Summary.Statistic, ci.lb = data$Lower.CI, ci.ub = data$Upper.CI,
slab = data$Health.Outcome,
psize = rep(1, length(data$Summary.Statistic)),
xlab = "Risk Ratio (RR)", refline = 1.0,
ylim = c(-0.5, 31), xlim = c(-6, 10),
ilab = c(data$Sample.size), ilab.xpos = -1,
at = c(0.5, 1.0, 2, 4, 8),
rows = c(1:2, 5, 8, 11:16, 19:27),
cex = 1.0, pch = shapes, header = "Health Outcome")
op <- par(cex=1.0, font=2)
text(-6, c(3, 6, 9, 17, 28), pos = 4,
c("Severe TBI", "Moderate to Severe TBI", "Moderate TBI", "Mild TBI", "TBI of any severity"))
op <- par(cex=1.0, font=2)
text(7.9, 30.1, "RR")
op <- par(cex=1.0, font=2)
text(-1, 30.1, "Sample Size")
op <- par(cex=0.9, font=3)
text(-5.5, -0.3, "Key")
legend(x = -5.7,
y = -0.3,
legend = c("Hazard Ratio", "Risk Ratio", "Converted to Risk Ratio"),
pch = c(15, 17, 18),
bty = "n",
cex = 0.8,
text.font = 1)
